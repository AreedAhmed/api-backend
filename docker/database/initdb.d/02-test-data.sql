TRUNCATE TABLE user;
INSERT INTO user (id, name, password, email, role)
VALUES (1, 'admin', '$2y$10$J/DF8J/Az8DiSEpXel18NOcN0qbYt5VSvKCc8oJFarXDtj7HkmCmK', 'admin@localhost', 'creator'),
       (2, 'writer1', '$2y$10$J/DF8J/Az8DiSEpXel18NOcN0qbYt5VSvKCc8oJFarXDtj7HkmCmK', 'writer1@localhost', 'writer'),
       (3, 'writer2', '$2y$10$J/DF8J/Az8DiSEpXel18NOcN0qbYt5VSvKCc8oJFarXDtj7HkmCmK', 'writer2@localhost', 'writer'),
       (4, 'writer3', '$2y$10$J/DF8J/Az8DiSEpXel18NOcN0qbYt5VSvKCc8oJFarXDtj7HkmCmK', 'writer3admin@localhost',
        'writer'),
       (5, 'reader', '$2y$10$J/DF8J/Az8DiSEpXel18NOcN0qbYt5VSvKCc8oJFarXDtj7HkmCmK', 'admin@localhost', 'reader');

TRUNCATE TABLE audit_log;
INSERT INTO audit_log (user_id, client_ip, action)
VALUES (1, INET_ATON('127.0.0.1'), 'Initialised system');

INSERT INTO project (id, name, description, is_template)
VALUES (1, 'Linux host template', 'Project template to show general linux host reconnaissance tasks', TRUE),
       (2, 'Web server pentest project', 'Test project to show pentest tasks and reports', FALSE),
       (3, 'Linux host', 'Test project to show general linux host reconnaissance tasks', FALSE),
       (4, 'Bug hunting',
        'List of tasks created by Sayaan Alam (@ehsayaan). A very systematic way of bug hunting. #bugbounty', TRUE);

INSERT INTO project_user (project_id, user_id)
VALUES (2, 1),
       (3, 1),
       (3, 2);

INSERT INTO target (project_id, name, kind)
VALUES (1, 'https://test.com', 'url'),
       (2, '127.0.0.1', 'hostname');

INSERT INTO vulnerability (project_id, target_id, reported_by_uid, summary, risk, cvss_score)
VALUES (1, 1, 1, 'Domain about to expire', 'medium', 6.4),
       (1, 2, 1, 'Open port (tcp/22)', 'medium', 6.6),
       (1, 2, 1, 'Test vulnerability #0', 'medium', 6.8),
       (1, 2, 1, 'Test vulnerability #1', 'medium', 4.7),
       (1, 2, 1, 'Test vulnerability #2', 'medium', 6.6),
       (1, 2, 1, 'Test vulnerability #3', 'low', 2.5),
       (1, 2, 1, 'Test vulnerability #4', 'none', 0.0),
       (1, 2, 1, 'Test vulnerability #5', 'low', 2.0),
       (1, 2, 1, 'Test vulnerability #6', 'low', 1.4),
       (1, 2, 1, 'Test vulnerability #7', 'low', 2.7),
       (1, 2, 1, 'Test vulnerability #8', 'low', 0.2),
       (1, 2, 1, 'Test vulnerability #9', 'critical', 9.3),
       (1, 2, 1, 'Test vulnerability #10', 'critical', 9.6),
       (1, 2, 1, 'Test vulnerability #11', 'medium', 5.2),
       (1, 2, 1, 'Test vulnerability #12', 'low', 2.8),
       (1, 2, 1, 'Test vulnerability #13', 'high', 7.7),
       (1, 2, 1, 'Test vulnerability #14', 'low', 0.1),
       (1, 2, 1, 'Test vulnerability #15', 'high', 7.9),
       (1, 2, 1, 'Test vulnerability #16', 'low', 2.5),
       (1, 2, 1, 'Test vulnerability #17', 'low', 2.0),
       (1, 2, 1, 'Test vulnerability #18', 'high', 7.4),
       (1, 2, 1, 'Test vulnerability #19', 'medium', 5.9),
       (1, 2, 1, 'Test vulnerability #20', 'medium', 4.8),
       (1, 2, 1, 'Test vulnerability #21', 'low', 2.1),
       (1, 2, 1, 'Test vulnerability #22', 'low', 1.5),
       (1, 2, 1, 'Test vulnerability #23', 'medium', 4.2),
       (1, 2, 1, 'Test vulnerability #24', 'medium', 6.8),
       (1, 2, 1, 'Test vulnerability #25', 'medium', 5.9),
       (1, 2, 1, 'Test vulnerability #26', 'low', 0.8),
       (1, 2, 1, 'Test vulnerability #27', 'high', 7.9),
       (1, 2, 1, 'Test vulnerability #28', 'medium', 4.8),
       (1, 2, 1, 'Test vulnerability #29', 'critical', 9.2),
       (1, 2, 1, 'Test vulnerability #30', 'low', 3.7),
       (1, 2, 1, 'Test vulnerability #31', 'medium', 5.6),
       (1, 2, 1, 'Test vulnerability #32', 'high', 8.6),
       (1, 2, 1, 'Test vulnerability #33', 'low', 3.6),
       (1, 2, 1, 'Test vulnerability #34', 'medium', 4.7),
       (1, 2, 1, 'Test vulnerability #35', 'low', 2.9),
       (1, 2, 1, 'Test vulnerability #36', 'low', 1.3),
       (1, 2, 1, 'Test vulnerability #37', 'low', 3.2),
       (1, 2, 1, 'Test vulnerability #38', 'low', 1.0),
       (1, 2, 1, 'Test vulnerability #39', 'critical', 9.6),
       (1, 2, 1, 'Test vulnerability #40', 'medium', 5.4),
       (1, 2, 1, 'Test vulnerability #41', 'critical', 9.4),
       (1, 2, 1, 'Test vulnerability #42', 'low', 0.5),
       (1, 2, 1, 'Test vulnerability #43', 'high', 8.7),
       (1, 2, 1, 'Test vulnerability #44', 'medium', 5.7),
       (1, 2, 1, 'Test vulnerability #45', 'low', 0.1),
       (1, 2, 1, 'Test vulnerability #46', 'critical', 9.9),
       (1, 2, 1, 'Test vulnerability #47', 'low', 1.1),
       (1, 2, 1, 'Test vulnerability #48', 'high', 8.9),
       (1, 2, 1, 'Test vulnerability #49', 'medium', 6.6),
       (1, 2, 1, 'Test vulnerability #50', 'medium', 4.8),
       (1, 2, 1, 'Test vulnerability #51', 'high', 7.5),
       (1, 2, 1, 'Test vulnerability #52', 'low', 2.4),
       (1, 2, 1, 'Test vulnerability #53', 'high', 7.0),
       (1, 2, 1, 'Test vulnerability #54', 'medium', 4.7),
       (1, 2, 1, 'Test vulnerability #55', 'medium', 6.1),
       (1, 2, 1, 'Test vulnerability #56', 'low', 0.4),
       (1, 2, 1, 'Test vulnerability #57', 'medium', 5.6),
       (1, 2, 1, 'Test vulnerability #58', 'medium', 6.9),
       (1, 2, 1, 'Test vulnerability #59', 'low', 3.0),
       (1, 2, 1, 'Test vulnerability #60', 'low', 2.3),
       (1, 2, 1, 'Test vulnerability #61', 'low', 2.3),
       (1, 2, 1, 'Test vulnerability #62', 'medium', 4.1),
       (1, 2, 1, 'Test vulnerability #63', 'medium', 6.4),
       (1, 2, 1, 'Test vulnerability #64', 'low', 0.3),
       (1, 2, 1, 'Test vulnerability #65', 'medium', 6.9),
       (1, 2, 1, 'Test vulnerability #66', 'low', 1.3),
       (1, 2, 1, 'Test vulnerability #67', 'low', 2.6),
       (1, 2, 1, 'Test vulnerability #68', 'high', 8.1),
       (1, 2, 1, 'Test vulnerability #69', 'high', 8.9),
       (1, 2, 1, 'Test vulnerability #70', 'low', 1.9),
       (1, 2, 1, 'Test vulnerability #71', 'low', 0.5),
       (1, 2, 1, 'Test vulnerability #72', 'medium', 4.2),
       (1, 2, 1, 'Test vulnerability #73', 'low', 2.2),
       (1, 2, 1, 'Test vulnerability #74', 'critical', 9.4),
       (1, 2, 1, 'Test vulnerability #75', 'low', 3.6),
       (1, 2, 1, 'Test vulnerability #76', 'low', 1.7),
       (1, 2, 1, 'Test vulnerability #77', 'critical', 9.4),
       (1, 2, 1, 'Test vulnerability #78', 'low', 0.3),
       (1, 2, 1, 'Test vulnerability #79', 'low', 2.8),
       (1, 2, 1, 'Test vulnerability #80', 'high', 7.5),
       (1, 2, 1, 'Test vulnerability #81', 'none', 0.0),
       (1, 2, 1, 'Test vulnerability #82', 'medium', 4.5),
       (1, 2, 1, 'Test vulnerability #83', 'low', 1.7),
       (1, 2, 1, 'Test vulnerability #84', 'medium', 5.0),
       (1, 2, 1, 'Test vulnerability #85', 'critical', 9.8),
       (1, 2, 1, 'Test vulnerability #86', 'medium', 4.6),
       (1, 2, 1, 'Test vulnerability #87', 'low', 0.5),
       (1, 2, 1, 'Test vulnerability #88', 'critical', 9.3),
       (1, 2, 1, 'Test vulnerability #89', 'critical', 9.6),
       (1, 2, 1, 'Test vulnerability #90', 'high', 8.6),
       (1, 2, 1, 'Test vulnerability #91', 'high', 7.5),
       (1, 2, 1, 'Test vulnerability #92', 'critical', 9.9),
       (1, 2, 1, 'Test vulnerability #93', 'high', 7.5),
       (1, 2, 1, 'Test vulnerability #94', 'high', 7.4),
       (1, 2, 1, 'Test vulnerability #95', 'low', 0.2),
       (1, 2, 1, 'Test vulnerability #96', 'critical', 9.6),
       (1, 2, 1, 'Test vulnerability #97', 'low', 2.8),
       (1, 2, 1, 'Test vulnerability #98', 'low', 1.6),
       (1, 2, 1, 'Test vulnerability #99', 'medium', 4.9);
UPDATE vulnerability
SET cvss_vector = 'CVSS:3.0/AV:P/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:H';

INSERT INTO task (project_id, parser, name, description)
VALUES (1, 'nmap', 'Run port scanner', 'nmap -oX out.xml -v -sS @@TARGET@@'),
       (1, 'sqlmap', 'Run SQL injection scanner',
        'python sqlmap.py -u @@TARGET@@ --method POST --data "username=foo&password=bar" -p username --level 5 --dbms=mysql -v 1 --tables'),
       (1, NULL, 'Check domain expiration date', 'whois @@TARGET@@'),
       (3, 'nmap', 'Run port scanner', 'nmap -oX out.xml -v -sS @@TARGET@@'),
       (3, 'sqlmap', 'Run SQL injection scanner',
        'python sqlmap.py -u @@TARGET@@ --method POST --data "username=foo&password=bar" -p username --level 5 --dbms=mysql -v 1 --tables'),
       (3, NULL, 'Check domain expiration date', 'whois @@TARGET@@'),
       (4, NULL, 'Find subdomains', ''),
       (4, NULL, 'Check CNAME records',
        'Check CNAME records of those subdomains. Check for subdomain takeover. Use wayback URLs on them too.'),
       (4, NULL, 'Do Port Scanning', 'Use MassScan for port scanning'),
       (4, NULL, 'Do Github recon', ''),
       (4, NULL, 'Check CORS misconfiguration', ''),
       (4, NULL, 'Check for email header injection on reset password function', ''),
       (4, NULL, 'Check for SMPT and HOST header injection', ''),
       (4, NULL, 'Check for Iframe', 'Check for Iframe (eg for clickjacking)'),
       (4, NULL, 'Check for improper access control and parameter tampering', ''),
       (4, NULL, 'Check Burp history for finding endpoint', ''),
       (4, NULL, 'Use arjun for finding hidden endpoints', ''),
       (4, NULL, 'Check for CSRF', ''),
       (4, NULL, 'Check for SSRF parameters', ''),
       (4, NULL, 'Check for XSS and SSTI', ''),
       (4, NULL, 'Check Cryptography in reset password token', ''),
       (4, NULL, 'Check for unicode injection in email parameter', ''),
       (4, NULL, 'Check for bypassing rate limit', ''),
       (4, NULL, 'Directory brute force', ''),
       (4, NULL, 'Check for HTTP request smuggling', ''),
       (4, NULL, 'Check for open redirect through wayback URLs', ''),
       (4, NULL, 'Check for Social-Signon bypass', ''),
       (4, NULL, 'Check for state parameter in social Sign-in',
        'Check whether it is possible to cause DoS using multiple cookies injection'),
       (4, NULL, 'File upload CSRF, XSS, SSRF, RCE, LFI, XXE', ''),
       (4, NULL, 'Check for Buffer overflow', '')
;

INSERT INTO task_result (task_id, submitted_by_uid, output)
VALUES (1, 1, 'tcp/22: open, tcp/80: open'),
       (1, 2, 'Domain expires in 22 days');
