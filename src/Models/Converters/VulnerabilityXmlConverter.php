<?php declare(strict_types=1);

namespace Reconmap\Models\Converters;

use DOMDocument;
use DOMElement;

class VulnerabilityXmlConverter
{
    public function toXml(DOMDocument $xmlDoc, array $vulnerability): DOMElement
    {
        $vulnerabilityEl = $xmlDoc->createElement('vulnerability');
        $vulnerabilityEl->setAttribute('summary', $vulnerability['summary']);

        $vulnerabilityDescriptionNode = $xmlDoc->createElement('description');
        if (isset($vulnerability['description'])) {
            $vulnerabilityDescriptionNode->appendChild($xmlDoc->createTextNode($vulnerability['description']));
        }
        $vulnerabilityEl->appendChild($vulnerabilityDescriptionNode);
        return $vulnerabilityEl;
    }
}
